#!/usr/bin/env sh
source $(dirname "$0")/.include.sh

DEST_PATH="web-client/src/gen"

echo "ğŸ§¹ Clear existing generated code"
rm -rf ${DEST_PATH}

echo "\nğŸ”¨ Generate Amplify schema, queries and models"
amplify api gql-compile
amplify codegen
amplify codegen models

echo "\nğŸ˜  Correct Amplify hardcoded output path"
mkdir ${DEST_PATH}
mv ${AMPLIFY_OUTPUT_PATH}/* ${DEST_PATH}
rmdir ${AMPLIFY_OUTPUT_PATH}

echo "\nâœ¨ Run prettier on generated code"
prettier -w ${DEST_PATH}

echo "âœ… Done!"
echo "\nâ˜ï¸  Don't forget to run 'amplify env pull' to generate aws-exports.js"
