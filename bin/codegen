#!/usr/bin/env sh

AMPLIFY_HARDCODED_MODELS_DIR="src"
GENERATED_CODE_OUTPUT_PATH="web-client/src/gen"

set -e

echo "ðŸ§¹ Clear existing generated code"
rm -rf ${GENERATED_CODE_OUTPUT_PATH}

echo "\nðŸ”¨ Generate Amplify queries, schema and models"
amplify codegen
amplify codegen models

echo "\nðŸ˜  Correct Amplify hardcoded model output path"
mkdir -p ${GENERATED_CODE_OUTPUT_PATH}/models
mv src/models ${GENERATED_CODE_OUTPUT_PATH}
rmdir src

echo "\nâœ¨ Run prettier on generated code"
prettier -w ${GENERATED_CODE_OUTPUT_PATH}

echo "\nâœ… Done!"
