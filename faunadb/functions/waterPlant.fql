Query(
  Lambda(
    ["plantId", "createdAt"],
    Let(
      { plant: Ref(Collection("Plant"), Var("plantId")) },
      Do(
        Create("PlantEvent", {
          data: {
            createdAt: Var("createdAt"),
            type: "WATERED",
            plant: Var("plant")
          }
        }),
        Update(Var("plant"), { lastWateredAt: Var("createdAt") })
      )
    )
  )
)
